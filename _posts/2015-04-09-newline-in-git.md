---
# MUST HAVE BEG
layout: post
disqus_identifier: 20150409-newline-in-git # DO NOT CHANGE THE VALUE ONCE SET
title: Gité‡Œçš„æ¢è¡Œç¬¦
# MUST HAVE END

subtitle: Newline in Git
tags: 
- git
date: 2015-04-09 20:13:00
image:
image_desc:
---

ä»Šå¤©åœ¨ä½¿ç”¨gitæ—¶é‡åˆ°ä¸€ä¸ªâ€œå¥‡æ€ªâ€çš„é—®é¢˜ã€‚æ“ä½œç³»ç»Ÿæ˜¯Windows 7ï¼Œåˆ†åˆ«åœ¨Git Bashå’Œcygwiné‡Œè¿è¡Œ
`git status`å‘½ä»¤ï¼Œè¾“å‡ºçš„ç»“æœç›¸å·®éå¸¸å¤§ã€‚cygwinä¸‹è¿è¡Œè¯¥å‘½ä»¤æç¤ºæœ‰å¤§é‡çš„æ–‡ä»¶è¢«ä¿®æ”¹äº†ï¼ˆâ€œChanges
not staged for commitâ€ï¼‰ï¼Œä½†æ˜¯å®é™…ä¸Šæˆ‘å¹¶æ²¡æœ‰å¯¹è¿™äº›æ–‡ä»¶åšè¿‡ä»»ä½•çš„æ”¹åŠ¨ã€‚

Googleäº†ä¸€ä¸‹åï¼Œå‘ç°æ˜¯æ¢è¡Œç¬¦å¯¼è‡´çš„é—®é¢˜ğŸ˜”ã€‚Unixï¼ŒLinuxå’ŒOS Xç”¨`LF`è¡¨ç¤ºæ¢è¡Œï¼ˆnew lineï¼‰ï¼Œè€Œ
Windowsç”¨`CRLF`è¡¨ç¤ºæ¢è¡Œã€‚gitåœ¨checkoutä¸€ä¸ªæ–‡ä»¶æ—¶å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ–¹å¼å¤„ç†æ¢è¡Œç¬¦ï¼š  
  
- æŠŠæ–‡æœ¬æ–‡ä»¶ä¸­çš„æ¢è¡Œç¬¦ç»Ÿä¸€è½¬æ¢æˆ`LF`    
- æŠŠæ–‡æœ¬æ–‡ä»¶ä¸­çš„æ¢è¡Œç¬¦ç»Ÿä¸€è½¬æ¢æˆ`CRLF`    
- æŠŠæ–‡æœ¬æ–‡ä»¶ä¸­çš„æ¢è¡Œç¬¦æ¢æˆæœ¬åœ°æ“ä½œç³»ç»Ÿä¸­çš„æ¢è¡Œç¬¦     
- è®¤ä¸ºè¿™ä¸ªæ–‡ä»¶æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸åšä»»ä½•å¤„ç†

åœ¨æˆ‘å·¥ä½œçš„è¿™ä¸ªä»“åº“ï¼ˆrepositoryï¼‰é‡Œï¼Œå¾ˆå¤šæ–‡ä»¶çš„æ¢è¡Œç¬¦ç­–ç•¥è¢«é…ç½®æˆâ€œè½¬æ¢ä¸ºæœ¬åœ°ç³»ç»Ÿçš„æ¢è¡Œç¬¦â€ã€‚
æˆ‘æ˜¯åœ¨Windowsä¸Šç”¨Git Bashå…‹éš†ä»“åº“çš„ï¼Œæ‰€ä»¥è¿™äº›æ–‡ä»¶çš„æ¢è¡Œç¬¦æ˜¯`CRLF`ã€‚å½“æˆ‘åœ¨cygwiné‡Œè¿è¡Œ
`git status`æ—¶ï¼Œgitä»¥ä¸ºè‡ªå·±è¿è¡Œåœ¨Unixç¯å¢ƒé‡ŒğŸ˜”ï¼Œæ‰€ä»¥å®ƒè®¤ä¸ºè¿™äº›æ–‡ä»¶çš„æ¢è¡Œç¬¦ä»`LF`è¢«æ¢æˆäº†
`CRLF`ã€‚

## More Details
å¦‚æœæˆ‘ä»¬çš„gitä»“åº“æ°¸è¿œéƒ½æ˜¯å·¥ä½œåœ¨åŒä¸€ç§æ“ä½œç³»ç»Ÿä¸‹ï¼Œé‚£ä¹ˆæ¢è¡Œç¬¦ç›¸å…³çš„é—®é¢˜å¯èƒ½ä¸ä¼šå›°æ‰°æˆ‘ä»¬ã€‚ä½†æ˜¯
å®é™…ä¸Šæˆ‘ä»¬å¸¸å¸¸ä¼šæœ‰æ„æ— æ„åœ°è·¨æ“ä½œç³»ç»Ÿè¿›è¡Œå·¥ä½œã€‚æ¯”å¦‚æ¥è‡ªä¸åŒçš„æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶å¯ä»¥é€šè¿‡Dropboxã€æµè§ˆå™¨
ã€å‹ç¼©åŒ…ç­‰é€”å¾„è¿›å…¥åˆ°æˆ‘ä»¬çš„gitä»“åº“ã€‚

gitæœ‰è‡ªå·±â€œæ•°æ®åº“â€ï¼ˆ.gitç›®å½•ï¼‰å­˜ç€æ‰€æœ‰çš„commitï¼›ä¹Ÿæœ‰â€œworking directoryâ€ï¼Œä¹Ÿå°±æ˜¯å½“å‰çš„å·¥ä½œ
ç›®å½•ã€‚ä¸ºäº†è§£å†³æ¢è¡Œç¬¦é—®é¢˜ï¼Œé¦–å…ˆæœ€å¥½æ˜¯è®©gitåœ¨å†™â€œæ•°æ®åº“â€æ—¶ä½¿ç”¨`LF`ä½œä¸ºæ¢è¡Œç¬¦ã€‚

ä¸‹é¢ä»‹ç»ä¸€ä¸‹gitä¸­æ¢è¡Œç¬¦ç›¸å…³çš„ä¸€äº›è®¾ç½®ã€‚
<!--more-->

### core.eol
é¦–å…ˆæ˜¯`core.eol`ã€‚å½“git**æŠŠæ–‡ä»¶checkoutåˆ°â€œworking directoryâ€æ—¶**å¦‚æœéœ€è¦æ”¹å˜æ¢è¡Œç¬¦ï¼Œä¼šæ ¹æ®è¿™ä¸ªé…ç½®æ¥è®¾ç½®æ¢è¡Œç¬¦ã€‚     

- `core.eol = native` è¿™æ˜¯é»˜è®¤å€¼ã€‚å½“gitéœ€è¦æ”¹å˜æ¢è¡Œç¬¦æ—¶ï¼ˆå†™æ–‡ä»¶åˆ°working directoryæ—¶ï¼‰ï¼Œç”¨nativeçš„æ¢è¡Œç¬¦
ã€‚ä¹Ÿå°±æ˜¯è¯´Windowsä¸‹ç”¨`CRLF`ï¼ŒUnix/Linux/OS Xä¸‹ç”¨`LF`ã€‚
- `core.eol = crlf` ä½¿ç”¨`CRLF`åšæ¢è¡Œç¬¦ã€‚
- `core.eol = lf` ä½¿ç”¨`LF`åšæ¢è¡Œç¬¦ã€‚

é€šè¿‡`git config --global core.eol`å¯ä»¥æŸ¥çœ‹è¿™ä¸ªé…ç½®çš„å€¼ã€‚å¦‚æœè¾“å‡ºæ˜¯ç©ºï¼Œè¡¨ç¤ºå€¼æ˜¯nativeã€‚ä¸€èˆ¬è€Œè¨€ï¼Œæœ€å¥½
ä¸è¦æ›´æ”¹è¿™ä¸ªé…ç½®ã€‚è¿™ä¸ªé…ç½®å¯¹æ¢è¡Œç¬¦çš„å½±å“éœ€è¦å…¶å®ƒé…ç½®çš„é…åˆã€‚ä¹Ÿå°±æ˜¯è¯´gitçš„â€œå…¶å®ƒé…ç½®â€æŒ‡å®šä»€ä¹ˆæƒ…å†µä¸‹
è¦æ”¹å˜æ¢è¡Œç¬¦ï¼Œè€Œè¿™ä¸ªé…ç½®æŒ‡å®šå¦‚æœè½¬æ¢å‘ç”Ÿæ—¶ï¼ˆä»â€œæ•°æ®åº“â€åˆ°â€œworking directoryâ€çš„è½¬æ¢ï¼‰æ¢è¡Œç¬¦åº”è¯¥ç”¨
å“ªä¸ªå€¼ã€‚

### .gitattributes
æˆ‘ä»¬å¯ä»¥åœ¨ä»“åº“çš„æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª.gitattributesæ–‡ä»¶ï¼Œå‘Šè¯‰gitåº”è¯¥æ€ä¹ˆå¤„ç†æ¢è¡Œç¬¦ã€‚

- `*.txt text` å‘Šè¯‰gitæ‰€æœ‰ä»¥`txt`ä¸ºåç¼€çš„æ–‡ä»¶éƒ½æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼ˆgitä¸ä¼šå¯¹äºŒè¿›åˆ¶æ–‡ä»¶åšæ¢è¡Œç¬¦è½¬æ¢ï¼‰ã€‚åœ¨
å†™â€œgitæ•°æ®åº“â€å‰æŠŠæ‰€æœ‰çš„`CRLF`éƒ½æ¢æˆ`LF`ã€‚åœ¨å†™æ–‡ä»¶åˆ°working directoryæ—¶ï¼Œä¹Ÿåšæ¢è¡Œç¬¦è½¬æ¢ï¼›æ¢è¡Œç¬¦
çš„å€¼å–å†³äº`core.eol`ã€‚
- `*.txt text eol=crlf` è¡Œä¸ºç±»ä¼¼ï¼Œåªä¸è¿‡åœ¨å†™working directoryæ—¶ä¸ç”¨`core.eol`ï¼Œè€Œæ˜¯`CRLF`ã€‚
`eol=crlf`ä¼šè¦†ç›–`core.eol`çš„å€¼ã€‚
- `*.txt -text` å¯¹æ‰€æœ‰ä»¥`txt`ä¸ºåç¼€çš„æ–‡ä»¶ï¼Œgitéƒ½ä¸ä¼šå¯¹å®ƒä»¬çš„æ¢è¡Œç¬¦åšä»»ä½•å¤„ç†ã€‚
- `*.txt text=auto` å¯¹æ‰€æœ‰ä»¥`txt`ä¸ºåç¼€çš„æ–‡ä»¶ï¼Œè®©gitå»å†³å®šå®ƒä»¬æ˜¯æ–‡æœ¬è¿˜æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ã€‚å¦‚æœgit
è®¤ä¸ºå®ƒä»¬æ˜¯æ–‡æœ¬å°±åšè½¬æ¢ã€‚
- `*.png binary` `binary`æ˜¯`-text -diff`çš„ç¼©å†™ã€‚`-diff`è¡¨ç¤ºgitä¸ä¼šå¯¹è¿™ç±»æ–‡ä»¶åšdiffã€‚

å»ºè®®åœ¨.gitattributesæ–‡ä»¶çš„å¼€å¤´åŠ ä¸Š`*	text=auto`ï¼Œè¿™æ ·å¯¹äº.gitattributesä¸­æ²¡æœ‰æŒ‡å®šçš„æ–‡ä»¶ç±»å‹
gitä¼šæ£€æŸ¥å®ƒä»¬æ˜¯ä¸æ˜¯æ–‡æœ¬ï¼Œå¦‚æœæ˜¯æ–‡æœ¬å°±åšæ¢è¡Œç¬¦è½¬æ¢ã€‚

æ³¨ï¼š     
`*	text=auto`åº”è¯¥æ”¾åœ¨ç¬¬ä¸€è¡Œï¼Œè¿™æ ·åç»­çš„è¡Œå¯ä»¥â€œè¦†ç›–â€å®ƒã€‚         
å¦‚æœæ²¡æœ‰åŠ `*	text=auto`ï¼Œè€Œä¸”æŸç§åç¼€çš„æ–‡ä»¶æ²¡æœ‰åœ¨.gitattributesä¸­æŒ‡å®šè§„åˆ™ï¼Œé‚£ä¹ˆgitä¼šæ ¹æ®
`core.autocrlf`æ¥è§‰å¾—å¦‚ä½•è½¬æ¢æ¢è¡Œç¬¦ï¼ˆåé¢ä»‹ç»ï¼‰ã€‚      
.gitattributesä¹Ÿä¼šåº”è¯¥diffçš„è¡Œä¸ºï¼Œè§å®ƒçš„å¸®åŠ©æ–‡æ¡£ã€‚

ä¸€ä¸ª.gitattributesæ–‡ä»¶çš„ä¾‹å­
	
	*         text
	
	# These files are text and should be normalized (convert crlf => lf)
	*.cs      text diff=csharp
	*.csproj  text
	*.sln     text
	*.tt      text
	
	# Images should be treated as binary
	# (binary is a macro for -text -diff)
	*.png     binary
	*.jepg    binary

ä¸Šé¢å…³äº.gitattributesçš„å†…å®¹é€‚ç”¨äº1.7.2ä¹‹åçš„gitç‰ˆæœ¬ã€‚

### å¯¹äº1.7.2ä¹‹å‰çš„gitç‰ˆæœ¬

`core.autocrlf`

- `core.autocrlf = false` gitæŠŠæ–‡æœ¬æ–‡ä»¶å†™å…¥å®ƒçš„â€œæ•°æ®åº“â€æ—¶ä¸åšä»»ä½•æ¢è¡Œç¬¦çš„è½¬æ¢ã€‚è¿™æ˜¯é»˜è®¤å€¼ã€‚
- `core.autocrlf = true` å†™â€œæ•°æ®åº“â€æ—¶`CRLF`ä¼šå˜æˆ`LF`ï¼›å†™working directoryæ—¶`LF`ä¼šå˜å›`CRLF`ã€‚
- `core.autocrlf = input` åªåœ¨å†™â€œæ•°æ®åº“â€æ—¶æŠŠ`CRLF`å˜æˆ`LF`ï¼›åè¿‡æ¥å†™working directoryæ—¶ä¸ä¼š
åšä»»ä½•åŠ¨ä½œã€‚

å¯ä»¥ç”¨`git config --global core.autocrlf`æ¥æŸ¥çœ‹è¯¥é…ç½®çš„å€¼ã€‚

`core.safecrlf`

- `core.safecrlf = true` åœ¨æŠŠ`CRLF`å˜æˆ`LF`å¹¶å†™å…¥â€œæ•°æ®åº“â€ä¹‹å‰ï¼Œgitä¼šçœ‹æ˜¯ä¸æ˜¯èƒ½å¤Ÿè½¬æ¢å›æ¥ã€‚å¦‚æœä¸èƒ½ï¼Œ
å°±æ”¾å¼ƒæ“ä½œã€‚
- `core.safecrlf = warn` å¦‚æœä¸èƒ½â€œäº’è½¬â€ï¼Œä»…ä»…è­¦å‘Šç”¨æˆ·ã€‚

.gitattributesæ–‡ä»¶     
`core.autocrlf`æ˜¯â€œå…¨å±€çš„â€é…ç½®ã€‚.gitattributesæ–‡ä»¶å¯ä»¥æŒ‰æ–‡ä»¶ç±»å‹æŒ‡å®šæ¢è¡Œç¬¦çš„è½¬æ¢ã€‚å®ƒå¯ä»¥æœ‰ç±»ä¼¼ä¸‹é¢çš„è¡Œã€‚

- `*.txt crlf` å¯¹æ‰€æœ‰åç¼€ä¸º`txt`çš„æ–‡ä»¶éƒ½åšè½¬æ¢ã€‚
- `*.txt -crlf` å¯¹æ‰€æœ‰åç¼€ä¸º`txt`çš„æ–‡ä»¶éƒ½ä¸åšè½¬æ¢ã€‚
- `*.txt crlf=input`å¯¹æ‰€æœ‰åç¼€ä¸º`txt`çš„æ–‡ä»¶ä»…åœ¨å†™å¦‚â€œæ•°æ®åº“â€æ—¶åšæ¢è¡Œç¬¦çš„è½¬æ¢ã€‚

## å‚è€ƒæ–‡æ¡£
[gitattributes man page](http://schacon.github.io/git/gitattributes.html) æˆ–è€…è¿è¡Œ`git help gitattributes`      
[gitattributes](http://git-scm.com/docs/gitattributes)       
[gitattributes](http://git-scm.com/book/en/v2/Customizing-Git-Git-Attributes)       
[Mind the End of Your Line](http://adaptivepatchwork.com/2012/03/01/mind-the-end-of-your-line/)       
[A github help](https://help.github.com/articles/dealing-with-line-endings/)            
  
